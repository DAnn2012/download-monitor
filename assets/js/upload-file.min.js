jQuery(function(r){let n=[];function l(e,t){t=t.attachment.attributes.url;const d=jQuery(e.settings.browse_button).parents("td").find("textarea");d.parent().removeClass("dlm-blury");let o=d.val();o=o?o+"\n"+t:t,d.val(o)}function a(e,t){const d=jQuery(e.settings.browse_button).parents("td").find("textarea");d.parent().addClass("dlm-blury")}function s(e,t){console.log(t),jQuery(e.settings.browse_button).parent().append('<p class="error description" style="color:red;">'+t.message+"</p>"),setTimeout(function(){jQuery(e.settings.browse_button).parent().find(".error.description").remove()},3500)}r(".dlm_upload_file").each((e,t)=>{n.push(r(t));const d={browser:r(t),plupload:{multi_selection:!1},params:{type:"dlm_download"}},o=new wp.Uploader(d);o.uploader.bind("FilesAdded",a),o.uploader.bind("FileUploaded",l),o.uploader.bind("Error",s)}),r(document).on("dlm_new_file_added",()=>{r(".dlm_upload_file").each((e,t)=>{if(n.includes(r(t)))return!0;n.push(r(t));const d={browser:r(t),plupload:{multi_selection:!1},params:{type:"dlm_download"}},o=new wp.Uploader(d);o.uploader.bind("FilesAdded",a),o.uploader.bind("FileUploaded",l),o.uploader.bind("Error",s)})})});