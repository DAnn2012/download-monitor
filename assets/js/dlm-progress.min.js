function attachButtonEvent(){let o="",n="";jQuery.each(dlmProgressVar.xhr_links.class,function(e,t){o+=n+" ."+t,n=","}),jQuery("html, body").on("click",o,function(e){handleDownloadClick(this,e)})}function handleDownloadClick(e,t){t.stopPropagation();const o=e;let n={button:e,href:o.getAttribute("href"),buttonObj:jQuery(e)};if(-1!==n.href.indexOf("blob:http"))return n.buttonObj.addClass("download-100"),void setTimeout(function(){n.buttonObj.removeClass("download-100")},1500);t.preventDefault(),retrieveBlob(n)}function retrieveBlob(e){const{button:n,href:t,buttonObj:r}=e;let d;const a=new XMLHttpRequest,l=r.attr("class");n.setAttribute("href","#"),n.removeAttribute("download"),n.setAttribute("disabled","disabled"),jQuery(document).trigger("dlm_download_triggered",[this,n,d]),a.responseType="blob",a.onreadystatechange=function(){var{status:e,readyState:t,statusText:o}=a;if(2==a.readyState&&a.status,404==e&&2==t){let e=document.createElement("p");e.innerHTML=o,n.parentNode.appendChild(e)}if(401==e&&2==t&&(window.location.href=o),403==e&&2==t){let e=document.createElement("p");e.innerHTML=o,n.parentNode.appendChild(e)}if(void 0===a.getResponseHeader("dlm-redirect")||""===a.getResponseHeader("dlm-redirect")||null===a.getResponseHeader("dlm-redirect")){if(200==e&&4==t){t=a.response;let e=a.getResponseHeader("Content-Disposition").split("filename=")[1];e=e.replace(/\"/g,"").replace(";",""),d=URL.createObjectURL(t),n.removeEventListener("click",handleDownloadClick),n.setAttribute("href",d),n.setAttribute("download",""+e),n.click(),setTimeout(function(){r.removeClass().addClass(l+" dlm-download-complete")},600),jQuery(document).trigger("dlm_download_downloaded",[this,n,d]),attachButtonEvent(),jQuery(document).trigger("dlm_download_complete",[this,n,d]),setTimeout(function(){window.URL.revokeObjectURL(d)},6e4)}}else window.location.href=a.getResponseHeader("dlm-redirect")},a.addEventListener("progress",function(e){var t=e.loaded/e.total*100,t=Math.round(t),o="download-"+10*Math.ceil(t/10);r.removeClass().addClass(l+" "+o),jQuery(document).trigger("dlm_download_progress",[this,n,d,e,t])}),a.onerror=function(){console.log("** An error occurred during the transaction")},a.open("GET",t,!0),a.setRequestHeader("dlm-request","dlm_XMLHttpRequest"),a.send()}attachButtonEvent();